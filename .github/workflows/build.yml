name: Build Simple Distribution

on:
  push:
    branches: [ master ]

jobs:
  build:
    runs-on: windows-latest

    steps:
      - uses: actions/checkout@v4

      - name: Set up JDK 21
        uses: actions/setup-java@v4
        with:
          java-version: '21'
          distribution: 'temurin'

      - name: Build JAR
        run: mvn clean package -DskipTests

      - name: Create Distribution Package
        run: |
          # Create distribution directory
          mkdir -p dist
          
          # Copy JAR
          copy target\*.jar dist\SolarDataPlotter.jar
          
          # Create run.bat
          @echo off > dist\run.bat
          echo @echo off >> dist\run.bat
          echo title Solar Data Plotter >> dist\run.bat
          echo java -jar "SolarDataPlotter.jar" >> dist\run.bat
          echo pause >> dist\run.bat
          
          # Create README
          echo # Solar Data Plotter > dist\README.txt
          echo. >> dist\README.txt
          echo ## How to Run: >> dist\README.txt
          echo 1. Install Java 21 or later >> dist\README.txt
          echo 2. Double-click run.bat >> dist\README.txt
          echo 3. Or run: java -jar SolarDataPlotter.jar >> dist\README.txt
          
          # Zip it
          Compress-Archive -Path dist\* -DestinationPath SolarDataPlotter-Windows.zip

      - name: Upload Distribution
        uses: actions/upload-artifact@v4
        with:
          name: SolarDataPlotter-Distribution
          path: |
            SolarDataPlotter-Windows.zip
            target\*.jar